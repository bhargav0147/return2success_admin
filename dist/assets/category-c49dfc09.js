import{c as B,cb as ce,r as a,j as e,cc as de,J as H,d as F,B as C,q as v,cW as W,d7 as Q,v as _,a as ue,d3 as me,p as L,d4 as ge,C as K,o as he,ai as pe,g as xe,W as Ce}from"./index-27ffd735.js";import{a as k}from"./format-time-4dc4f2eb.js";import{C as fe}from"./custom-breadcrumbs-891ee9b7.js";import{g as je,c as ye}from"./utils-b5337f6b.js";import{u as we}from"./use-table-ad19f892.js";import{T as X,c as be,d as Pe,b as Se,e as De}from"./table-pagination-custom-61c144d7.js";import{C as ve}from"./confirm-dialog-31af3c64.js";import{T as y}from"./TablePagination-488334e4.js";import{D as Y}from"./Dialog-5a3d7487.js";import{D as Z}from"./DialogTitle-eb11eb3a.js";import{D as ee}from"./DialogContent-90bef667.js";import{D as te}from"./DialogContentText-38b36ed8.js";import{T as V}from"./TextField-18c86d14.js";import{D as se}from"./DialogActions-29076f9a.js";import{B as G}from"./Box-531386b9.js";import{S as Re}from"./Stack-81f38202.js";import{I as Te}from"./InputAdornment-babdc070.js";import{T as ke,a as Fe,b as Oe}from"./TableContainer-f8ac8b22.js";import"./index-e5978b8b.js";import"./empty-content-67ee3c7b.js";import"./Checkbox-ca090919.js";import"./SwitchBase-cff1fcb3.js";import"./useFormControl-146f88ba.js";import"./FormControlLabel-4c76a5b9.js";import"./formControlState-a1fb9590.js";import"./Switch-356d0d7d.js";import"./KeyboardArrowRight-44da873a.js";import"./FirstPage-6da56183.js";import"./Select-7c65bb90.js";import"./Menu-02e5c653.js";import"./List-1e1da31b.js";import"./utils-a73c94d0.js";import"./InputBase-894de89e.js";import"./dialogTitleClasses-80e3b880.js";import"./FormControl-26894946.js";import"./FormLabel-fae9cf0f.js";function ae({idex:t,row:m,selected:w,reloadFn:c,onViewRow:g,onSelectRow:r,onDeleteRow:h,isRegister:p,isPromotion:b,getAllCategory:o}){const{id:d,type:x}=m,n=B();B();const u=ce(),[U,O]=a.useState(""),[R,T]=a.useState(!1);a.useState(!1);const[q,E]=a.useState(""),$=()=>{T(!0)},[f,P]=a.useState(),I=async()=>{try{(await W.put(`/api/admin/businesstypes/${d}`,{categorytype:f})).status===200&&(o(),S(),Q("Category Updated Successfully",{variant:"success"}))}catch(j){console.error(j)}},M=j=>{P(j.target.value),console.log(f)},S=()=>{T(!1),O(""),E("")};a.useEffect(()=>{console.log("id====>",m)},[m]);const A=e.jsxs(X,{hover:!0,children:[e.jsx(y,{children:t}),e.jsx(y,{align:"center",children:x}),e.jsxs(y,{sx:{display:"flex",justifyContent:"center"},children:[e.jsx(C,{disabled:status==="approved"||status==="rejected"||status==="expired",color:"success",variant:"contained",onClick:()=>{$()},children:"Edit"}),e.jsxs(Y,{open:R,onClose:S,children:[e.jsx(Z,{id:"alert-dialog-title",sx:{width:"500px"},children:"Edit Category"}),e.jsx(ee,{sx:{px:3},children:e.jsx(te,{id:"alert-dialog-description",children:e.jsx(V,{id:"outlined-basic",fullWidth:!0,label:"Category Name",variant:"outlined",sx:{mt:1},defaultValue:x,onChange:M})})}),e.jsxs(se,{sx:{pb:2},children:[e.jsx(C,{onClick:S,variant:"contained",autoFocus:!0,children:"Cancel"}),e.jsx(C,{onClick:()=>I(),variant:"contained",children:"Submit"})]})]})]})]});return e.jsxs(e.Fragment,{children:[A,e.jsxs(de,{open:u.open,onClose:u.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(H,{onClick:()=>{n.onTrue(),u.onClose()},sx:{color:"error.main"},children:[e.jsx(F,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),e.jsxs(H,{onClick:()=>{g(),u.onClose()},children:[e.jsx(F,{icon:"solar:eye-bold"}),"View"]})]}),e.jsx(ve,{open:n.value,onClose:n.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(C,{variant:"contained",color:"error",onClick:h,children:"Delete"})})]})}ae.propTypes={onDeleteRow:v.func,onSelectRow:v.func,onViewRow:v.func,row:v.object,selected:v.bool};const J={name:"",status:"all",startDate:null,endDate:null};function Ee(){const t=we({defaultOrderBy:"orderNumber"}),m=_(),w=ue();B();const[c,g]=a.useState(me),[r,h]=a.useState(J),[p,b]=a.useState(""),[o,d]=a.useState(""),x=r.startDate&&r.endDate?r.startDate.getTime()>r.endDate.getTime():!1,n=Ie({inputData:c,comparator:je(t.order,t.orderBy),filters:r,dateError:x}),u=n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage),U=t.dense?52:72,O=!!r.name||r.status!=="all"||!!r.startDate&&!!r.endDate,R=a.useCallback((s,i)=>{t.onResetPage(),h(l=>({...l,[s]:i}))},[t]),T=a.useCallback(s=>{const i=c.filter(l=>l.id!==s);g(i),t.onUpdatePageDeleteRow(u.length)},[u.length,t,c]);a.useCallback(()=>{const s=c.filter(i=>!t.selected.includes(i.id));g(s),t.onUpdatePageDeleteRows({totalRows:c.length,totalRowsInPage:u.length,totalRowsFiltered:n.length})},[n.length,u.length,t,c]),a.useCallback(()=>{h(J)},[]);const q=a.useCallback(s=>{w.push(L.dashboard.order.details(s))},[w]);a.useCallback((s,i)=>{R("status",i)},[R]);const E=ge(),f=new URLSearchParams(E.search).get("page"),[P,I]=a.useState([]),[M,S]=a.useState(Number(f)||1),[A,j]=a.useState(1);a.useEffect(()=>{S(Number(f))},[f]),a.useState(t.rowsPerPage);const D=a.useCallback(async()=>{var s,i;try{const l=await W.get(`/api/admin/businesstypes?limit=${t.rowsPerPage}&page=${t.page+1}&search=${p}`);I(l.data.data.results),j((i=(s=l==null?void 0:l.data)==null?void 0:s.data)==null?void 0:i.total)}catch(l){console.error(l)}},[t.rowsPerPage,t.page,p]),oe=async()=>{try{(await W.post("/api/admin/businesstypes",{categorytype:o})).status===200&&(D(),N(),Q("Category Updated Successfully",{variant:"success"}))}catch(s){console.error(s)}},re=!n.length&&O||!n.length;a.useEffect(()=>{D(),console.log("pagelimite===>",t.rowsPerPage)},[D,t.rowsPerPage]),a.useState("all");const[ne,z]=a.useState(!1),ie=()=>{z(!0)},N=()=>{z(!1),d("")},le=s=>{d(s.target.value)};return e.jsx(e.Fragment,{children:e.jsxs(K,{maxWidth:m.themeStretch?!1:"lg",children:[e.jsxs(G,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(fe,{heading:"Category",links:[{name:"Dashboard",href:L.dashboard.root},{name:"Order",href:L.dashboard.order.root},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsxs(G,{children:[e.jsx(C,{variant:"contained",onClick:ie,startIcon:e.jsx(F,{icon:"mingcute:add-line"}),children:"Add Category"}),e.jsxs(Y,{open:ne,onClose:N,children:[e.jsx(Z,{id:"alert-dialog-title",sx:{width:"500px"},children:"Add Category"}),e.jsx(ee,{sx:{px:3},children:e.jsx(te,{id:"alert-dialog-description",children:e.jsx(V,{id:"outlined-basic",fullWidth:!0,label:"Category Name",variant:"outlined",sx:{mt:1},value:o,onChange:le})})}),e.jsxs(se,{sx:{pb:2},children:[e.jsx(C,{onClick:N,variant:"contained",autoFocus:!0,children:"Cancel"}),e.jsx(C,{onClick:oe,variant:"contained",children:"Submit"})]})]})]})]}),e.jsx(Re,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1,mb:5},children:e.jsx(V,{fullWidth:!0,placeholder:"Search...",onChange:s=>{b(s.target.value),console.log(p)},InputProps:{startAdornment:e.jsx(Te,{position:"start",children:e.jsx(F,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsxs(he,{children:[e.jsx(ke,{sx:{position:"relative",overflow:"unset"},children:e.jsx(pe,{children:e.jsxs(Fe,{size:t.dense?"small":"medium",sx:{minWidth:"100%"},children:[e.jsx(be,{children:e.jsxs(X,{children:[e.jsx(y,{sx:{width:"10%"},children:"Sr no."}),e.jsx(y,{align:"center",children:"Category"}),e.jsx(y,{sx:{display:"flex",justifyContent:"center"},children:"Action"})]})}),e.jsxs(Oe,{children:[P==null?void 0:P.map((s,i)=>e.jsx(ae,{idex:i+1,getAllCategory:D,row:s,selected:t.selected.includes(s.id),onSelectRow:()=>t.onSelectRow(s.id),onDeleteRow:()=>T(s.id),onViewRow:()=>q(s.id),reloadFn:D},s.id)),(n==null?void 0:n.length)>0&&e.jsx(Pe,{height:U,emptyRows:ye(t.page,t.rowsPerPage,n.length)}),e.jsx(Se,{notFound:re})]})]})})}),e.jsx(De,{count:A,page:t.page,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onRowsPerPageChange:t.onChangeRowsPerPage,dense:t.dense,onChangeDense:t.onChangeDense})]})]})})}function Ie({inputData:t,comparator:m,filters:w,dateError:c}){const{status:g,name:r,startDate:h,endDate:p}=w,b=t.map((o,d)=>[o,d]);return b.sort((o,d)=>{const x=m(o[0],d[0]);return x!==0?x:o[1]-d[1]}),t=b.map(o=>o[0]),r&&(t=t.filter(o=>o.orderNumber.toLowerCase().indexOf(r.toLowerCase())!==-1||o.customer.name.toLowerCase().indexOf(r.toLowerCase())!==-1||o.customer.email.toLowerCase().indexOf(r.toLowerCase())!==-1)),g!=="all"&&(t=t.filter(o=>o.status===g)),c||h&&p&&(t=t.filter(o=>k(o.createdAt)>=k(h)&&k(o.createdAt)<=k(p))),t}function Ae(){xe();const t=_();return e.jsx(K,{maxWidth:t.themeStretch?!1:"xl",children:e.jsx(Ee,{})})}function Ct(){return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:e.jsx("title",{children:" Dashboard: Category"})}),e.jsx(Ae,{})]})}export{Ct as default};

import{v as V,a as W,c as z,r,d3 as H,p as w,d4 as $,d5 as q,j as s,C as G,o as J,k as K,F as M,ai as X,B as Y,cW as Z}from"./index-27ffd735.js";import{a as b}from"./format-time-4dc4f2eb.js";import{C as ee}from"./confirm-dialog-31af3c64.js";import{C as te}from"./custom-breadcrumbs-891ee9b7.js";import{g as ae}from"./utils-b5337f6b.js";import{u as se}from"./use-table-ad19f892.js";import{a as le,b as oe}from"./table-pagination-custom-61c144d7.js";import{O as re}from"./order-table-row-e371dba6.js";import{T as ne,a as de}from"./Tabs-a75c564a.js";import{T as ie,a as ce,b as ue}from"./TableContainer-f8ac8b22.js";import{S as me}from"./Stack-81f38202.js";import{P as ge}from"./Pagination-5cbd8de4.js";const he=[{value:"all",label:"All"},{value:"Pending",label:"Pending"},{value:"Accepted",label:"Accepted"},{value:"Rejected",label:"Rejected"}],fe=[{id:"name",label:"Name"},{id:"contact",label:"Contact No"},{id:"createdAt",label:"Cr. Date"},{id:"totalAmount",label:"Amount"},{id:"status",label:"Status"},{id:"Action",label:"Action"}],A={name:"",status:"all",startDate:null,endDate:null};function Fe(){var S,T;const t=se({defaultOrderBy:"orderNumber"}),C=V(),p=W(),g=z(),[n,c]=r.useState(H),[o,h]=r.useState(A),x=o.startDate&&o.endDate?o.startDate.getTime()>o.endDate.getTime():!1,l=pe({inputData:n,comparator:ae(t.order,t.orderBy),filters:o,dateError:x}),d=l.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage);t.dense,o.name||o.status!=="all"||o.startDate&&o.endDate;const f=r.useCallback((e,a)=>{t.onResetPage(),h(m=>({...m,[e]:a}))},[t]),D=r.useCallback(e=>{const a=n.filter(m=>m.id!==e);c(a),t.onUpdatePageDeleteRow(d.length)},[d.length,t,n]),F=r.useCallback(()=>{const e=n.filter(a=>!t.selected.includes(a.id));c(e),t.onUpdatePageDeleteRows({totalRows:n.length,totalRowsInPage:d.length,totalRowsFiltered:l.length})},[l.length,d.length,t,n]);r.useCallback(()=>{h(A)},[]);const L=r.useCallback(e=>{p.push(w.dashboard.order.details(e))},[p]),k=r.useCallback((e,a)=>{f("status",a)},[f]),O=$();new URLSearchParams(O.search),console.log("pageQuery===>",1);const[u,B]=r.useState([]),[v,N]=r.useState(1),[E,I]=r.useState(1),U=q(),_=(e,a)=>{N(a),U("/dashboard/booking?page="+a),console.log(a)},P=async()=>{var e,a,m,y;try{const i=await Z(`/api/admin/payout/?sortBy=created_at&sortOrder=desc&page=${v}&perpage=7`);B((a=(e=i==null?void 0:i.data)==null?void 0:e.data)==null?void 0:a.values),I((y=(m=i==null?void 0:i.data)==null?void 0:m.data)==null?void 0:y.totalPages)}catch(i){console.error(i)}};r.useEffect(()=>{P()},[v]);const[j,Q]=r.useState("all"),R=e=>e==="all"?u:u.filter(a=>a.status===e);return s.jsxs(s.Fragment,{children:[s.jsxs(G,{maxWidth:C.themeStretch?!1:"lg",children:[s.jsx(te,{heading:"Payout",links:[{name:"Dashboard",href:w.dashboard.root},{name:"Order",href:w.dashboard.order.root},{name:"List"}],sx:{mb:{xs:3,md:5}}}),s.jsxs(J,{children:[s.jsx(ne,{value:o.status,onChange:k,sx:{px:2.5,boxShadow:e=>`inset 0 -2px 0 0 ${K(e.palette.grey[500],.08)}`},children:he.map(e=>s.jsx(de,{onClick:()=>Q(e.value),iconPosition:"end",value:e.value,label:e.label,icon:s.jsxs(M,{variant:(e.value==="all"||e.value===o.status)&&"filled"||"soft",color:e.value==="Accepted"&&"success"||e.value==="Pending"&&"warning"||e.value==="Rejected"&&"error"||"default",children:[e.value==="all"&&u.length,e.value==="Pending"&&u.filter(a=>a.status==="Pending").length,e.value==="Accepted"&&u.filter(a=>a.status==="Accepted").length,e.value==="Rejected"&&u.filter(a=>a.status==="Rejected").length,e.value==="refunded"&&u.filter(a=>a.status==="refunded").length]})},e.value))}),s.jsx(ie,{sx:{position:"relative",overflow:"unset"},children:s.jsx(X,{children:s.jsxs(ce,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[s.jsx(le,{order:t.order,orderBy:t.orderBy,headLabel:fe,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:e=>t.onSelectAllRows(e,n.map(a=>a.id))}),s.jsxs(ue,{children:[(S=R(j))==null?void 0:S.map(e=>s.jsx(re,{row:e,selected:t.selected.includes(e.id),onSelectRow:()=>t.onSelectRow(e.id),onDeleteRow:()=>D(e.id),onViewRow:()=>L(e.id),reloadFn:P},e.id)),s.jsx(oe,{notFound:!((T=R(j))!=null&&T.length)})]})]})})}),s.jsx(me,{alignItems:"center",justifyContent:"center",style:{padding:10},children:s.jsx(ge,{page:v,count:E,onChange:_,color:"primary"})})]})]}),s.jsx(ee,{open:g.value,onClose:g.onFalse,title:"Delete",content:s.jsxs(s.Fragment,{children:["Are you sure want to delete ",s.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:s.jsx(Y,{variant:"contained",color:"error",onClick:()=>{F(),g.onFalse()},children:"Delete"})})]})}function pe({inputData:t,comparator:C,filters:p,dateError:g}){const{status:n,name:c,startDate:o,endDate:h}=p,x=t.map((l,d)=>[l,d]);return x.sort((l,d)=>{const f=C(l[0],d[0]);return f!==0?f:l[1]-d[1]}),t=x.map(l=>l[0]),c&&(t=t.filter(l=>l.orderNumber.toLowerCase().indexOf(c.toLowerCase())!==-1||l.customer.name.toLowerCase().indexOf(c.toLowerCase())!==-1||l.customer.email.toLowerCase().indexOf(c.toLowerCase())!==-1)),n!=="all"&&(t=t.filter(l=>l.status===n)),g||o&&h&&(t=t.filter(l=>b(l.createdAt)>=b(o)&&b(l.createdAt)<=b(h))),t}export{Fe as O};

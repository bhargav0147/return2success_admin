import{v as L,c as k,r as n,dS as C,j as t,S as j,p as x,dR as I,dQ as E,cP as G,dW as q,C as B,B as _,R as N,d as P,W}from"./index-27ffd735.js";import{o as T}from"./orderBy-631f93a1.js";import{a as g}from"./format-time-4dc4f2eb.js";import{E as A}from"./empty-content-67ee3c7b.js";import{C as D}from"./custom-breadcrumbs-891ee9b7.js";import{a as U,b as V,c as Q,d as z,e as H}from"./tour-details-view-c78b44d9.js";import"./_baseToString-c85d59f0.js";import"./_baseIteratee-9e852688.js";import"./_baseEach-4159b158.js";import"./index-e5978b8b.js";import"./format-number-bf5061ab.js";import"./image-7d02ef11.js";import"./custom-date-range-picker-5d847698.js";import"./Dialog-5a3d7487.js";import"./DialogTitle-eb11eb3a.js";import"./dialogTitleClasses-80e3b880.js";import"./DialogContent-90bef667.js";import"./DatePicker-3e2c25a6.js";import"./TextField-18c86d14.js";import"./FormControl-26894946.js";import"./utils-a73c94d0.js";import"./useFormControl-146f88ba.js";import"./formControlState-a1fb9590.js";import"./FormLabel-fae9cf0f.js";import"./Select-7c65bb90.js";import"./Menu-02e5c653.js";import"./List-1e1da31b.js";import"./InputBase-894de89e.js";import"./InputAdornment-babdc070.js";import"./DialogActions-29076f9a.js";import"./ListItem-fe933c2f.js";import"./ListItemSecondaryAction-d2bd79ed.js";import"./Chip-a5be7a74.js";import"./ListItemText-ff35796a.js";import"./Pagination-5cbd8de4.js";import"./FirstPage-6da56183.js";import"./index-0c5ce7cc.js";import"./search-not-found-e6059c5f.js";import"./Autocomplete-b5c308cf.js";import"./Close-d91a1546.js";import"./FormControlLabel-4c76a5b9.js";import"./Checkbox-ca090919.js";import"./SwitchBase-cff1fcb3.js";import"./rhf-autocomplete-cc9ff921.js";import"./upload-avatar-5c17c7d6.js";import"./fade-27de7a97.js";import"./file-thumbnail-bdf7cfb6.js";import"./index-b7215938.js";import"./FormGroup-6550ea98.js";import"./Switch-356d0d7d.js";import"./editor-7e7ca674.js";import"./highlight-d4e5d3fc.js";import"./Slider-8f570469.js";import"./visuallyHidden-14c3de6e.js";import"./RadioGroup-d8b34bea.js";import"./Radio-a65c6d92.js";import"./yup-c975ca61.js";import"./CardHeader-8b482d81.js";import"./LoadingButton-405ddbf1.js";import"./CircularProgress-a33cd36e.js";import"./markdown-61d29bd3.js";import"./use-light-box-5fb5e135.js";import"./Tabs-a75c564a.js";import"./KeyboardArrowRight-44da873a.js";const R={destination:[],tourGuides:[],services:[],startDate:null,endDate:null};function J(){const e=L(),l=k(),[a,S]=n.useState("latest"),[i,d]=n.useState({query:"",results:[]}),[r,c]=n.useState(R),f=r.startDate&&r.endDate?r.startDate.getTime()>r.endDate.getTime():!1,m=K({inputData:C,filters:r,sortBy:a,dateError:f}),s=!!r.destination.length||!!r.tourGuides.length||!!r.services.length||!!r.startDate&&!!r.endDate,p=!m.length&&s,b=n.useCallback((o,u)=>{c(h=>({...h,[o]:u}))},[]),y=n.useCallback(o=>{S(o)},[]),O=n.useCallback(o=>{if(d(u=>({...u,query:o})),o){const u=C.filter(h=>h.name.toLowerCase().indexOf(i.query.toLowerCase())!==-1);d(h=>({...h,results:u}))}},[i.query]),F=n.useCallback(()=>{c(R)},[]),v=t.jsxs(j,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[t.jsx(U,{query:i.query,results:i.results,onSearch:O,hrefItem:o=>x.dashboard.tour.details(o)}),t.jsxs(j,{direction:"row",spacing:1,flexShrink:0,children:[t.jsx(V,{open:l.value,onOpen:l.onTrue,onClose:l.onFalse,filters:r,onFilters:b,canReset:s,onResetFilters:F,serviceOptions:I.map(o=>o.label),tourGuideOptions:E,destinationOptions:G,dateError:f}),t.jsx(Q,{sort:a,onSort:y,sortOptions:q})]})]}),w=t.jsx(z,{filters:r,onResetFilters:F,canReset:s,onFilters:b,results:m.length});return t.jsxs(B,{maxWidth:e.themeStretch?!1:"lg",children:[t.jsx(D,{heading:"List",links:[{name:"Dashboard",href:x.dashboard.root},{name:"Tour",href:x.dashboard.tour.root},{name:"List"}],action:t.jsx(_,{component:N,href:x.dashboard.tour.new,variant:"contained",startIcon:t.jsx(P,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),t.jsxs(j,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[v,s&&w]}),p&&t.jsx(A,{title:"No Data",filled:!0,sx:{py:10}}),t.jsx(H,{tours:m})]})}const K=({inputData:e,filters:l,sortBy:a,dateError:S})=>{const{services:i,destination:d,startDate:r,endDate:c,tourGuides:f}=l,m=f.map(s=>s.id);return a==="latest"&&(e=T(e,["createdAt"],["desc"])),a==="oldest"&&(e=T(e,["createdAt"],["asc"])),a==="popular"&&(e=T(e,["totalViews"],["desc"])),S||r&&c&&(e=e.filter(s=>g(s.available.startDate)>=g(r)&&g(s.available.endDate)<=g(c))),d.length&&(e=e.filter(s=>d.includes(s.destination))),m.length&&(e=e.filter(s=>s.tourGuides.some(p=>m.includes(p.id)))),i.length&&(e=e.filter(s=>s.services.some(p=>i.includes(p)))),e};function ie(){return t.jsxs(t.Fragment,{children:[t.jsx(W,{children:t.jsx("title",{children:" Dashboard: Tour List"})}),t.jsx(J,{})]})}export{ie as default};
